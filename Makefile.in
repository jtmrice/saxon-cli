
SHELL = @bash@

PACKAGE_NAME = @PACKAGE_NAME@
prefix = @prefix@
datarootdir = @datarootdir@
datadir = @datadir@

exec_prefix = @exec_prefix@
bindir = @bindir@
srcdir = @srcdir@

# @var98283@

package_share_dir = $(datadir)/$(PACKAGE_NAME)

gradle = @gradle@
sed = @sed@
install = @INSTALL@
mkdir_p = @MKDIR_P@
m4 = @m4@

SRC_BIN_FILES = $(wildcard $(srcdir)/src/bin/*)

OUT_SHARE_FILES = $(wildcard $(srcdir)/out/share/*)
OUT_BIN_FILES = $(patsubst $(srcdir)/src/bin/%,$(srcdir)/out/bin/%,$(SRC_BIN_FILES))

INSTALL_SHARE_FILES = $(patsubst $(srcdir)/out/share/%,$(package_share_dir)/%,$(OUT_SHARE_FILES))
INSTALL_BIN_FILES = $(patsubst $(srcdir)/out/bin/%,$(bindir)/%,$(OUT_BIN_FILES))
INSTALL_FILES = $(INSTALL_SHARE_FILES) $(INSTALL_BIN_FILES)

BUILT_GRADLE_OUT_TOKEN = $(srcdir)/out/

.PHONY: default
default: build

.PHONY: build
build: $(OUT_BIN_FILES)
	$(gradle) out

.PHONY: debug
debug:
	@ printf "SRC_BIN_FILES=\"%s\"\n" $(SRC_BIN_FILES)
	@ printf "OUT_BIN_FILES=\"%s\"\n" $(OUT_BIN_FILES)
	@ printf "OUT_SHARE_FILES=\"%s\"\n" $(OUT_SHARE_FILES)
	@ printf "INSTALL_SHARE_FILES=\"%s\"\n" $(INSTALL_SHARE_FILES)
	@ printf "INSTALL_BIN_FILES=\"%s\"\n" $(INSTALL_BIN_FILES)
	@ printf "INSTALL_FILES=\"%s\"\n" $(INSTALL_FILES)

$(srcdir)/out/bin/%: $(srcdir)/src/bin/% $(srcdir)/src/macros.m4
	$(mkdir_p) $(dir $@)
	$(m4) -DCONFIG_PACKAGE_SHARE_DIR=$(package_share_dir) -DCONFIG_BIN_DIR=$(bindir) --prefix-builtins $(srcdir)/src/macros.m4 $< > $@

.PHONY: install
install: $(INSTALL_FILES)

$(package_share_dir)/%: $(srcdir)/out/share/%
	$(RM) -f $@
	$(mkdir_p) $(dir $@)
	$(install) --mode=644 $< $(dir $@)

$(bindir)/%: $(srcdir)/out/bin/%
	$(RM) -f $@
	$(mkdir_p) $(dir $@)
	$(install) --mode=755 $< $(dir $@)

.PHONY: clean
clean:
	$(RM) -r out

